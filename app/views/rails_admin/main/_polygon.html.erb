<script>
  function initShapeField() {
    jQuery(function() {
      // var latitude = <%#= field.latitude %>;
      // var longitude = <%#= field.longitude %>;
      // var latlng = new google.maps.LatLng(latitude, longitude);

      var myOptions = {
        zoom: <%= field.default_zoom_level %>,
        // center: latlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        scrollwheel: false
      };

      var map = new google.maps.Map(document.getElementById("shape_map"), myOptions);

      var locations = {
            "type": "FeatureCollection",
            "features": [
                { "type": "Feature", "properties": { "shape": "Polygon", "name": "Unnamed Layer", "category": "default" }, "geometry": <%= raw field.shape.to_json %>},
                // { "type": "Feature", "properties": { "shape": "Polygon", "name": "Unnamed Layer", "category": "default" }, "geometry": {"type":"MultiPolygon","coordinates":[[[[24.5700703604651,-32.3017111802326],[24.5702454937473,-32.3017987468737],[24.57017,-32.301843],[24.5700703604651,-32.3017111802326]]],[[[24.5694628023256,-32.3009074011628],[24.569834,-32.301093],[24.569834,-32.3013984832536],[24.5694628023256,-32.3009074011628]]],[[[24.5701675232364,-32.3002597616182],[24.570334,-32.300343],[24.570334,-32.300843],[24.569834,-32.301093],[24.5694628023256,-32.3009074011628],[24.569334,-32.300737],[24.5701675232364,-32.3002597616182]]],[[[24.569834,-32.3013984832536],[24.569834,-32.301093],[24.570334,-32.300843],[24.570834,-32.301093],[24.570834,-32.3014537747073],[24.5702454937473,-32.3017987468737],[24.5700703604651,-32.3017111802326],[24.569834,-32.3013984832536]]],[[[24.570834,-32.301093],[24.570334,-32.300843],[24.570334,-32.300343],[24.570834,-32.300093],[24.571334,-32.300343],[24.571334,-32.300843],[24.570834,-32.301093]]],[[[24.570834,-32.3014537747073],[24.570834,-32.301093],[24.571334,-32.300843],[24.5716264769297,-32.3009892384649],[24.570834,-32.3014537747073]]],[[[24.5716264769297,-32.3009892384649],[24.571334,-32.300843],[24.571334,-32.300343],[24.571834,-32.300093],[24.572334,-32.300343],[24.572334,-32.3005745007026],[24.5716264769297,-32.3009892384649]]],[[[24.572334,-32.3005745007026],[24.572334,-32.300343],[24.572834,-32.300093],[24.5730074601121,-32.3001797300561],[24.572334,-32.3005745007026]]],[[[24.570834,-32.2998781666268],[24.570834,-32.300093],[24.570334,-32.300343],[24.5701675232364,-32.3002597616182],[24.570834,-32.2998781666268]]],[[[24.5715660521565,-32.2994590260782],[24.571834,-32.299593],[24.571834,-32.300093],[24.571334,-32.300343],[24.570834,-32.300093],[24.570834,-32.2998781666268],[24.5715660521565,-32.2994590260782]]],[[[24.572334,-32.2990193332536],[24.572334,-32.299343],[24.571834,-32.299593],[24.5715660521565,-32.2994590260782],[24.572334,-32.2990193332536]]],[[[24.572334,-32.300343],[24.571834,-32.300093],[24.571834,-32.299593],[24.572334,-32.299343],[24.572834,-32.299593],[24.572834,-32.300093],[24.572334,-32.300343]]],[[[24.5729645810766,-32.2986582905383],[24.573334,-32.298843],[24.573334,-32.299343],[24.572834,-32.299593],[24.572334,-32.299343],[24.572334,-32.2990193332536],[24.5729645810766,-32.2986582905383]]],[[[24.5730074601121,-32.3001797300561],[24.572834,-32.300093],[24.572834,-32.299593],[24.573334,-32.299343],[24.573834,-32.299593],[24.573834,-32.2996952266979],[24.5730074601121,-32.3001797300561]]],[[[24.573834,-32.299593],[24.573334,-32.299343],[24.573334,-32.298843],[24.573834,-32.298593],[24.574334,-32.298843],[24.574334,-32.299343],[24.573834,-32.299593]]],[[[24.573834,-32.2996952266979],[24.573834,-32.299593],[24.574334,-32.299343],[24.5743884432945,-32.2993702216473],[24.573834,-32.2996952266979]]],[[[24.5743884432945,-32.2993702216473],[24.574334,-32.299343],[24.574334,-32.298843],[24.574834,-32.298593],[24.575334,-32.298843],[24.575334,-32.299343],[24.5753336182785,-32.2993431908607],[24.57444,-32.29934],[24.5743884432945,-32.2993702216473]]],[[[24.5753336182785,-32.2993431908607],[24.575334,-32.299343],[24.5753343872128,-32.2993431936064],[24.5753336182785,-32.2993431908607]]],[[[24.5753343872128,-32.2993431936064],[24.575334,-32.299343],[24.575334,-32.298843],[24.575834,-32.298593],[24.576334,-32.298843],[24.576334,-32.299343],[24.5763265274769,-32.2993467362616],[24.5753343872128,-32.2993431936064]]],[[[24.5763265274769,-32.2993467362616],[24.576334,-32.299343],[24.57634158002,-32.29934679001],[24.5763265274769,-32.2993467362616]]],[[[24.57634158002,-32.29934679001],[24.576334,-32.299343],[24.576334,-32.298843],[24.576834,-32.298593],[24.577334,-32.298843],[24.577334,-32.299343],[24.5773194366752,-32.2993502816624],[24.57634158002,-32.29934679001]]],[[[24.5773194366752,-32.2993502816624],[24.577334,-32.299343],[24.5773487728272,-32.2993503864136],[24.5773194366752,-32.2993502816624]]],[[[24.5773487728272,-32.2993503864136],[24.577334,-32.299343],[24.577334,-32.298843],[24.577834,-32.298593],[24.578334,-32.298843],[24.578334,-32.299343],[24.5783123458736,-32.2993538270632],[24.5773487728272,-32.2993503864136]]],[[[24.5783123458736,-32.2993538270632],[24.578334,-32.299343],[24.5783559656344,-32.2993539828172],[24.5783123458736,-32.2993538270632]]],[[[24.5783559656344,-32.2993539828172],[24.578334,-32.299343],[24.578334,-32.298843],[24.578834,-32.298593],[24.579334,-32.298843],[24.579334,-32.299343],[24.5793052550719,-32.2993573724641],[24.5783559656344,-32.2993539828172]]],[[[24.5793052550719,-32.2993573724641],[24.579334,-32.299343],[24.5793631584416,-32.2993575792208],[24.5793052550719,-32.2993573724641]]],[[[24.5793631584416,-32.2993575792208],[24.579334,-32.299343],[24.579334,-32.298843],[24.579834,-32.298593],[24.580334,-32.298843],[24.580334,-32.298916904943],[24.579481,-32.299358],[24.5793631584416,-32.2993575792208]]],[[[24.580334,-32.298916904943],[24.580334,-32.298843],[24.5804931235585,-32.2987634382208],[24.580533,-32.298814],[24.580334,-32.298916904943]]],[[[24.5736760243902,-32.2980140121951],[24.573834,-32.298093],[24.573834,-32.298593],[24.573334,-32.298843],[24.5729645810766,-32.2986582905383],[24.573517,-32.298342],[24.5736760243902,-32.2980140121951]]],[[[24.5740662682927,-32.2972091341463],[24.574334,-32.297343],[24.574334,-32.297843],[24.573834,-32.298093],[24.5736760243902,-32.2980140121951],[24.5740662682927,-32.2972091341463]]],[[[24.574334,-32.298843],[24.573834,-32.298593],[24.573834,-32.298093],[24.574334,-32.297843],[24.574834,-32.298093],[24.574834,-32.298593],[24.574334,-32.298843]]],[[[24.574834,-32.298093],[24.574334,-32.297843],[24.574334,-32.297343],[24.574834,-32.297093],[24.575334,-32.297343],[24.575334,-32.297843],[24.574834,-32.298093]]],[[[24.575834,-32.298145329588],[24.575834,-32.298593],[24.575334,-32.298843],[24.574834,-32.298593],[24.574834,-32.298093],[24.575334,-32.297843],[24.5753450967331,-32.2978485483666],[24.575212,-32.298143],[24.575834,-32.298145329588]]],[[[24.5753450967331,-32.2978485483666],[24.575334,-32.297843],[24.575334,-32.297343],[24.5756435799731,-32.2971882100134],[24.5753450967331,-32.2978485483666]]],[[[24.576834,-32.2981490749064],[24.576834,-32.298593],[24.576334,-32.298843],[24.575834,-32.298593],[24.575834,-32.298145329588],[24.576834,-32.2981490749064]]],[[[24.577834,-32.2981528202247],[24.577834,-32.298593],[24.577334,-32.298843],[24.576834,-32.298593],[24.576834,-32.2981490749064],[24.577834,-32.2981528202247]]],[[[24.578834,-32.2981565655431],[24.578834,-32.298593],[24.578334,-32.298843],[24.577834,-32.298593],[24.577834,-32.2981528202247],[24.578834,-32.2981565655431]]],[[[24.579834,-32.2981603108614],[24.579834,-32.298593],[24.579334,-32.298843],[24.578834,-32.298593],[24.578834,-32.2981565655431],[24.579834,-32.2981603108614]]],[[[24.5804931235585,-32.2987634382208],[24.580334,-32.298843],[24.579834,-32.298593],[24.579834,-32.2981603108614],[24.580018,-32.298161],[24.5804931235585,-32.2987634382208]]],[[[24.5744565121951,-32.2964042560976],[24.574834,-32.296593],[24.574834,-32.297093],[24.574334,-32.297343],[24.5740662682927,-32.2972091341463],[24.5744565121951,-32.2964042560976]]],[[[24.5748467560976,-32.2955993780488],[24.575334,-32.295843],[24.575334,-32.296343],[24.574834,-32.296593],[24.5744565121951,-32.2964042560976],[24.5748467560976,-32.2955993780488]]],[[[24.5756435799731,-32.2971882100134],[24.575334,-32.297343],[24.574834,-32.297093],[24.574834,-32.296593],[24.575334,-32.296343],[24.575834,-32.296593],[24.575834,-32.2967669413119],[24.5756435799731,-32.2971882100134]]],[[[24.5759355826613,-32.2965422086694],[24.575834,-32.296593],[24.575334,-32.296343],[24.575334,-32.295843],[24.575834,-32.295593],[24.5762668192618,-32.2958094096309],[24.5759355826613,-32.2965422086694]]],[[[24.575834,-32.2967669413118],[24.575834,-32.296593],[24.5759355826613,-32.2965422086694],[24.575834,-32.2967669413118]]],[[[24.575334,-32.2945944375],[24.575334,-32.294843],[24.57517492,-32.29492254],[24.575334,-32.2945944375]]],[[[24.57517492,-32.29492254],[24.575334,-32.294843],[24.575834,-32.295093],[24.575834,-32.295593],[24.575334,-32.295843],[24.5748467560976,-32.2955993780488],[24.57517492,-32.29492254]]],[[[24.5758500812044,-32.2941010406022],[24.576334,-32.294343],[24.576334,-32.294843],[24.575834,-32.295093],[24.575334,-32.294843],[24.575334,-32.2945944375],[24.575469,-32.294316],[24.5758500812044,-32.2941010406022]]],[[[24.5762668192618,-32.2958094096309],[24.575834,-32.295593],[24.575834,-32.295093],[24.576334,-32.294843],[24.5766355082732,-32.2949937541366],[24.5762668192618,-32.2958094096309]]],[[[24.5766355082732,-32.2949937541366],[24.576334,-32.294843],[24.576334,-32.294343],[24.576799571338,-32.294110214331],[24.57695,-32.294298],[24.5766355082732,-32.2949937541366]]],[[[24.576799571338,-32.294110214331],[24.576334,-32.294343],[24.5758500812044,-32.2941010406022],[24.576499,-32.293735],[24.576799571338,-32.294110214331]]]]}}
            ]
        };
      map.data.addGeoJson(locations)

    });
  }
</script>

<%= javascript_include_tag "https://maps.googleapis.com/maps/api/js?key=#{field.google_api_key}&sensor=false&callback=initShapeField" %>

<div id="shape_map" style="margin: 20px 0; padding: 0; height: <%= field.map_height %>px; width: 100%;">
</div>
